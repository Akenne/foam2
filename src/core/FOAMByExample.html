<html>
 <head>
  <script language="javascript" src="stdlib.js"></script>
  <script language="javascript" src="mm.js"></script>
  <script language="javascript" src="debug.js"></script>
  <title>FOAM By Example</title>
  <style>
    code {color:blue;}
  </style>
 </head>

 <body style="font-family:monospace;">

<script id='demo' language="xjavascript">
foam.CLASS({
  name: 'Test1',
  properties: [
    // short-form
    'a',
    // long-form
    {
      name: 'b'
    }
  ],
  methods: [
    // short-form
    function f1() { return 1; },
    // long-form
    {
      name: 'f2',
      code: function() { return 2; }
    }
  ]
});
var t1 = Test1.create({a:1, b:'foo'});
log(t1.a, t1.b, t1.f1(), t1.f2());
t1.a++;
t1.b = 'bar';
log(t1.a, t1.b);

log(Test1.toString());

log(t1.toString());

Test1.describe();

t1.describe();

log(Test1.getAxiomByName('a'));

// BUG: bind shouldn't be required
log(Test1.getAxiomsByClass(Method).map(Method.NAME.f.bind(Method.NAME)));

</script>

  <div id='output'></div>

  <script language="javascript">
    var demo = document.getElementById('demo');
    var out  = document.getElementById('output');
    var log_ = function(o) {
      if ( o.indexOf('<') != 0 ) o = o.replace(/\n/g, '<br>').replace(/ /g,'&nbsp;');
//      out.innerHTML = out.innerHTML + o + '<br/>';
      document.body.insertAdjacentHTML('beforeend', o + '<br/>');
    }
    var oldLog = console.log;
    console.log = function() { log_([].join.call(arguments, ' ')); };
    console.log.put = console.log.bind(console);
    console.log.str = oldLog.str;
    console.log.json = oldLog.json;
    var log = function() { log_(' <b>&gt;</b> ' + [].join.call(arguments, ' ')); }

    var s = demo.textContent.split('\n\n');
    for ( var i = 0 ; i < s.length ; i++ ) {
      var l = s[i];
      log_(' <h3>Test ' + (i+1) + '</h3><code>' + l + '</code><br>');
      eval(l);
      log_('');
    }
  </script>

 </body>
</html>
